<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Loejee's Portfolio</title>
		<!-- Tailwind CSS -->
		<script src="https://cdn.tailwindcss.com"></script>
		<!-- Noto Sans from Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap"
			rel="stylesheet"
		/>
		<style>
			body {
				font-family: "Noto Sans", sans-serif;
				background-color: #f3f4f6;
				color: #1f2937;
			}
			/* Grid for project images */
			.project-image-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
				gap: 1rem;
			}
			/* Modal styles */
			.modal {
				display: none;
				position: fixed;
				z-index: 50;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.8);
				align-items: center;
				justify-content: center;
			}
			.modal-content {
				max-width: 90%;
				max-height: 90%;
				object-fit: contain;
				border-radius: 8px;
			}
			.close {
				position: absolute;
				top: 20px;
				right: 30px;
				color: white;
				font-size: 40px;
				font-weight: bold;
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<%- include('../partials/head'); %>
		<div class="min-h-screen p-4 md:p-8">
			<!-- Projects Section -->
			<section
				class="bg-white rounded-3xl shadow-xl max-w-5xl mx-auto p-8 md:p-12"
			>
				<div class="text-center mb-8 md:mb-10">
					<h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">
						My Projects
					</h1>
					<p class="text-gray-600">
						A showcase of my recent work and creations.
					</p>
				</div>

				<!-- Projects Grid -->
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					<% if (projects && projects.length > 0) { %> <%
					projects.forEach(function(project) { %>
					<div class="bg-blue-50 p-6 rounded-2xl shadow-md flex flex-col">
						<% if (project.images && project.images.length > 0) { %>
						<div class="project-image-grid mb-4">
							<% project.images.slice(0, 1).forEach(function(image, index) { %>
							<img
								src="<%= image %>"
								alt="<%= project.name %> thumbnail <%= index + 1 %>"
								class="w-full h-48 object-cover rounded-xl shadow-sm mb-2 cursor-pointer"
								onerror="this.onerror=null;this.src='https://placehold.co/400x200/cccccc/333333?text=Image+Unavailable';"
								onclick="openModal('<%= image %>', '<%= project.name %> thumbnail <%= index + 1 %>')"
							/>
							<% }); %>
						</div>
						<% } else { %>
						<img
							src="https://placehold.co/400x200/cccccc/333333?text=No+Image"
							alt="No image available"
							class="w-full h-48 object-cover rounded-xl shadow-sm mb-4"
						/>
						<% } %>

						<h3 class="text-xl font-bold text-gray-900 mb-2 flex-grow-0">
							<%= project.name %>
						</h3>
						<div class="text-gray-700 text-sm leading-relaxed mb-4 flex-grow">
							<%- project.content %>
						</div>

						<div
							class="flex flex-wrap gap-3 mt-auto pt-4 border-t border-gray-200"
						>
							<% if (project.href) { %>
							<a
								href="<%= project.href %>"
								target="_blank"
								rel="noopener noreferrer"
								class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-blue-700 transition-colors duration-200 shadow-sm"
							>
								View Project
							</a>
							<% } %> <% if (project.googlePlayHref) { %>
							<a
								href="<%= project.googlePlayHref %>"
								target="_blank"
								rel="noopener noreferrer"
								class="bg-green-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-green-700 transition-colors duration-200 shadow-sm"
							>
								Google Play
							</a>
							<% } %>
						</div>
					</div>
					<% }); %> <% } else { %>
					<p class="text-gray-500 text-center col-span-full">
						No projects listed yet.
					</p>
					<% } %>
				</div>
			</section>
		</div>

		<!-- Modal for Zoomed Image -->
		<div id="imageModal" class="modal">
			<span class="close" onclick="closeModal()">&times;</span>
			<img class="modal-content" id="modalImage" alt="Zoomed project image" />
		</div>

		<script>
			function openModal(imageSrc, altText) {
				const modal = document.getElementById("imageModal");
				const modalImg = document.getElementById("modalImage");
				modal.style.display = "flex";
				modalImg.src = imageSrc;
				modalImg.alt = altText;
			}

			function closeModal() {
				const modal = document.getElementById("imageModal");
				modal.style.display = "none";
			}

			// Close modal when clicking outside the image
			document
				.getElementById("imageModal")
				.addEventListener("click", function (event) {
					if (event.target === this) {
						closeModal();
					}
				});

			// Close modal with Escape key
			document.addEventListener("keydown", function (event) {
				if (event.key === "Escape") {
					closeModal();
				}
			});
		</script>
	</body>
</html>
